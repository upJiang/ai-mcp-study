version: '3.8'

services:
  eventanalyzer:
    build:
      context: ./packages/EventAnalyzer
      dockerfile: ../../deployment/Dockerfile.python-mcp
    container_name: mcp-eventanalyzer
    environment:
      - PYTHONUNBUFFERED=1
      - MCP_TRANSPORT=http
      - MCP_PORT=8000
      - MCP_BASE_PATH=/mcp/eventanalyzer  # Nginx 代理路径前缀
      - EVENT_API_BASE_URL=${EVENT_API_BASE_URL:-https://tptest-3d66.top/trans/api/event}  # 埋点 API 地址
    ports:
      - "8100:8000"  # 映射容器端口 8000 到宿主机端口 8100
    restart: unless-stopped
    networks:
      - mcp-network
    logging:
      driver: "json-file"
      options:
        max-size: "10m"
        max-file: "3"

networks:
  mcp-network:
    driver: bridge
